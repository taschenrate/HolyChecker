AvnChecker — Техническое задание
Это финальная версия ТЗ для чекера AvnChecker и веб-панели администрирования. Всё взаимодействие идёт через сайт и Supabase, без Telegram-бота. Документ объединяет старое подробное ТЗ по функционалу чекера и новое структурированное ТЗ, переработанные под единую архитектуру.
1. Общая информация о продукте
Название: AvnChecker
Версия: 1.0.0
Платформа: Windows 10+ (x64)
Язык разработки клиента: C# (.NET 6–8)
Web-панель: React + Vite + TypeScript
Backend / БД: Supabase (Postgres + RPC)
Цель: помощь модераторам/проверяющим при проверке игроков Minecraft и околоигровой активности.
Приложение не содержит вредоносного ПО, работает локально и отправляет результаты проверки в Supabase.
Разработчик: Avn (Telegram: @avnmanager).
2. Архитектура системы (Desktop + Web + Supabase)
Компоненты:
1) Десктоп-приложение AvnChecker — выполняет все проверки на ПК проверяемого.
2) Веб-панель — интерфейс для администраторов и проверяющих:
  • генерация одноразовых кодов доступа для чекера;
  • просмотр результатов проверок;
  • управление чёрным списком и ролями.
3) Supabase — единый центр данных (Postgres + RPC-функции).

Общий поток:
- Проверяющий заходит в веб-панель и генерирует одноразовый код.
- Вводит этот код в десктоп-чекер.
- Чекер валидирует код через RPC и открывает функционал.
- После проверки чекер отправляет детальный JSON-отчёт и статус в Supabase.
- Веб-панель отображает данные для проверяющих и админов.
3. UI и основные экраны десктоп-чекера AvnChecker
3.1. Стартовый экран — ввод одноразового кода
Назначение: не дать использовать чекер без кода, сгенерированного через веб-панель.

Функционал:
- Поле ввода кода (6 символов: A–Z, 0–9).
- Кнопка «Подтвердить».
- При нажатии отправляется запрос к Supabase RPC validate_code_for_checker.
- При успешной валидации — переход к основному интерфейсу.
- При ошибке — сообщение: код не найден / истёк / уже использован.
- До успешной проверки кода вкладки чекера недоступны.
3.2. Основное меню и стиль
Требования к UI:
- Тёмная цветовая схема: чёрный / тёмно-серый фон + оранжевые акценты (кнопки, скроллбар, активные элементы).
- В правом верхнем углу: текст "AvnChecker v1.0.0".
- Слева вертикальное меню с разделами:
 • Информация
 • Приложения
 • О системе
 • Твинки
 • Mods
 • Настройки
- Внизу левого меню: иконки GitHub, сайта/канала, текст DEVELOPER.
- Все карточки и панели — тёмно-серые, с мягкими углами и оранжевым ховером.

3.3. Экран «Информация»
Цель: показать базовую информацию о программе и разработчике.

Содержимое:
- Заголовок: «Информация».
- Текст о том, что программа помогает проверять игроков, не является вредоносной и работает локально.
- Информация о разработчике и контакте.
- Две карточки в ряд:
 • APP — AvnChecker
 • VERSION — 1.0.0
3.4. Экран «Приложения»
Цель: быстрый запуск/скачивание вспомогательных инструментов (Everything, Shellbag Analyzer и т.д.).

Функционал:
- Сетка кнопок, по клику — скачивание соответствующей программы по OfficialDownloadUrl.
- Путь сохранения: .\Tools\{Имя_приложения}\...
- Показ статуса: «Скачивается…», «Скачано», «Ошибка».
- Список программ берётся из конфигурации (жёстко зашитый или конфиг-файл).
3.5. Экран «О системе»
Цель: собрать и показать информацию о системе игрока и важные маркеры.

Левая часть:
- Аватар (инициал имени), имя пользователя.
- Имя ПК (Environment.MachineName).
- Имя текущего Windows-пользователя.

Правая часть ("Статистика системы"):
- Количество экранов.
- Аптайм системы (формат: X д Y ч Z мин).
- Название ОС (Windows 10 Pro 10.0.x).
- Дата установки ОС (если не определить — «Неизвестно»).
- Версия Windows и номер сборки.
- Процессор.
- Видеокарта (первая или список).
- Материнская плата (или «Неизвестно»).
- Признак виртуальной машины (ДА/НЕТ), детект по Hyper-V/VMware/VirtualBox и т.д.
- HWID — стабильный идентификатор по железу (материнка/CPU/диски).
- Очистка журналов:
 • System, Event ID 104 — статус (НЕ НАЙДЕНО/ОБНАРУЖЕНО) и дата последнего события.
 • Application, Event ID 3079 — статус и дата последнего события.

Эти данные должны уходить в блок system JSON-отчёта.
3.6. Экран «Твинки»
Цель: найти «твинки» (альтернативные аккаунты) по конфигах Minecraft-клиентов.

Директории для сканирования:
- %AppData%\.minecraft
- %AppData%\.tlauncher\legacy\Minecraft\game
- Директория активного Minecraft-клиента (по запущенному процессу javaw.exe/лаунчера).

Файлы и логика:
- tlauncher_profiles.json — собрать все "username".
- usercache.json — собрать все "name".
- LabyMod\accounts.json и labymod-neo\accounts.json — собрать "username".
- .minecraft\config\ias.json — вытащить ники (через JSON-парсинг или поиск строк/регулярки).
- При ошибках чтения JSON — не падать, а логировать.

UI вкладки:
- Таблица с колонками: Ник / Источник / Путь к файлу.
- Кнопка «Пересканировать».
- Кнопка «Скопировать» (копирует все результаты в буфер обмена).
- Кнопка «Скачать» (сохраняет результат в .txt, например AvnChecker_Twinks_YYYYMMDD_HHMMSS.txt).

Эти данные уходят в блок twinks JSON-отчёта.
3.7. Экран «Mods»
Цель: показать все моды Minecraft на ПК.

Логика:
- Искать папки mods, modpacks, versions/*/mods в:
 • %AppData%\.minecraft
 • %AppData%\.tlauncher\legacy\Minecraft\game
 • директории активного клиента.
- Внутри искать *.jar и *.zip.
- Не сканировать лишние директории (Downloads и т.п.).
- По возможности использовать асинхронное/многопоточное сканирование.

UI:
- Статус сверху: «Сканирование... (найдено X модов)».
- Таблица с колонками: Название файла / Размер (МБ) / Путь / (опционально) Клиент.
- При клике по строке — открывать проводник Windows в директории с файлом.

Эти данные идут в блок mods JSON-отчёта.
3.8. Экран «Настройки»
Минимум:
- Язык интерфейса (если будет).
- Режимы логирования.
- Возможно: указание кастомных путей к клиентам/логам.
- Кнопка «Экспорт конфигурации» (json) и «Сброс к дефолту».
4. Дамп процесса игры и поиск внедрений (инжекты, cheat-клиенты)
AvnChecker должен уметь дампить процесс игрового клиента (обычно javaw.exe) и выполнять поиск внедрений, инжектов и сигнатур cheat-клиентов (DoomsDay, Troxil, cortex и др.).
4.1. Логика дампа и анализа
- Найти процесс игры (javaw.exe или кастомный .exe клиента Minecraft).
- Считать нужные области памяти (по возможности безопасно, с учётом прав доступа).
- Прогнать содержимое по набору регулярных выражений и строк.
- Результат анализа оформить в блок injects JSON-отчёта:
 • found (true/false) — найдено ли хоть что-то из списка;
 • matches — массив найденных сигнатур/паттернов;
 • decision — текстовое резюме (например, "doomsday_detected", "troxil_detected", "hitbox_injection" и т.п.);
 • comment — человекочитаемое пояснение.
- При наличии критичных сигнатур — по умолчанию предлагать статус проверки "чит".
4.2. Регулярные выражения и паттерны для javaw.exe
Regex (case-insensitive) для процесса javaw.exe:
(ASM:|H(q=Zf@wDLF?/d?D&|x/fC5K<;i/f6I\-w\[|SMe;8#xj0s<\+pyE&bEZ|cR_A\^yvDVSXDYPQp\]|cortex|r\|\~\}Xnpo\>\]_\^'@BA|WYX\-gih\>rssK\{\|\|\[|net/minecraft/client/renderer/RenderState\$\$Lambda\+0x000001e7d29d9930|7ba\{vsdkvhd\}o\}w|Hba\{vsdkvhduy\{q|Fba\{vsdkvhdpxhz|Aba\{vsdkvhdnxhv|x/mo/c|Self Destruct|blessed|stubborn\.website|cortex|E S P|Hitbox:|Reach:|chs/Main|chs/Profiler|net\.minecraftforge\.ASMEventHandler\.31\.wait\(long, int\)|magicthein|radioegor146|BaoBab:|b/time|chs/90|by\.kayn|ZDCoder|dreampool|TriggerBOT|forge\.commons\.|sjuuOiqotmus)
4.3. Комментарии к основным сигнатурам
- DoomsDay client — специфические строки (H(q=Zf@wDLF?/d?D& и др.) → автопризнак чита.
- Troxil client — набор закодированных строк (free/legit/beta) → автопризнак чита.
- cortex — строка cortex / api.cortexclient.com → чит-клиент.
- squad client free — x/mo/c → чит.
- Francium — Self Destruct → подозрение.
- blessed crack — blessed → чит.
- stubborn.website — mp3 хиты → чит.
- E S P / Hitbox: / Reach: — хитбокс/ESP инжекты.
- chs/Main, chs/Profiler, net.minecraftforge.ASMEventHandler.31.wait(...) — хитбоксы/автобай.
- magicthein, radioegor146 — конвертер .jar→.dll и прочие модификации.
- BaoBab:, b/time, chs/90, by.kayn, ZDCoder, dreampool, TriggerBOT, forge.commons., sjuuOiqotmus — специфичные следы cheat-модов и клиентов.

В случае обнаружения любой из этих групп сигнатур чекер должен отразить это в отчёте и предложить статус "чит" (с возможностью ручной коррекции проверяющим).
4.4. DPS-метки (для справки, не для бана)
Список DPS-тегов хранится и может использоваться как доп. информация (например, подсветка клиента), но сам по себе НЕ является основанием для бана.
Regex (case-insensitive) | DPS:
(?:2023/03/09:17:11:30|2023/07/03:22:01:11|2023/10/04:16:07:05|2024/04/05:11:43:39|2025/05/28:23:57:12|2076/05/18:04:53:15|2024/05/02:22:48|2024/09/06:09:35:50|2023/08/13:13:09:58|2025/01/20:21:37:53|2025/01/16:14:21:21|2022/06/07:07:45:55)
5. Идентификация, логирование и расширенный анализ
Этот блок агрегирует дополнительные требования из исходного ТЗ по функционалу чекера.
5.1. HWID и идентификация
- Использовать HWID вместо MAC (MAC легко подменяется).
- HWID формировать на основе CPU, материнской платы и серийников дисков.
- HWID должен быть стабильным между запусками и меняться только при реальном изменении железа.
- HWID игрока передаётся в Supabase вместе с результатом проверки.
5.2. Процесс-сканер
- Реализовать модуль активного мониторинга процессов.
- Отслеживать процессы, которые могут влиять на Minecraft (вспомогательные лаунчеры, дебаггеры, инжекторы).
- Сохранять список подозрительных процессов в отчёт (source_code.extra.processes).
5.3. Advanced / AI-проверки (опционально, но с контрактом)
- Анализ изменений файлов: история, переименования, время модификации (через доступные логи / утилиты).
- DLL-анализ по сигнатурам (можно вынести как отдельный модуль, результаты — в extra.dll_scan).
- Поиск удалённых файлов через Prefetch, USN Journal, системный кэш.
- Возможность в будущем добавлять NN/ML-модели для автоматического выявления новых читов.
- Все такие проверки не ломают основной поток: при ошибках модуль просто пишет в лог и продолжает работу.
5.4. Автопоиск твинков по HWID + IP (серверный уровень)
- На стороне Supabase/веб-панели может быть реализована аналитика:
 • группировка проверок по HWID;
 • доп. учёт IP (если он будет добавлен в протокол);
 • подсветка потенциальных твинков в отчётах.
- Чекер должен хотя бы корректно передавать HWID; IP может добавлять сервер.
6. Интеграция с Supabase (без Telegram, только сайт + чекер)
6.1. Структура БД (основные таблицы)
1) users — пользователи веб-панели.
  - id (uuid)
  - email / login
  - role (user/checker/admin)
  - nickname
  - created_at

2) auth_codes — одноразовые коды для чекера.
  - id (uuid)
  - code (text, 6 символов)
  - checker_id (uuid → users.id)
  - checker_name (text)
  - status (new/used/expired)
  - created_at (timestamptz)
  - expires_at (timestamptz)

3) checks — результаты проверок.
  - id (bigserial)
  - checker_id (uuid)
  - player_nick (text)
  - player_hwid (text)
  - status (clean/cheat/probably_cheat)
  - source_code (jsonb или text)
  - checked_at (timestamptz, nullable)
  - created_at (timestamptz)

4) blacklist — чёрный список.
  - id (bigserial)
  - player_nick (text)
  - player_hwid (text)
  - reason (text)
  - added_by (uuid → users.id)
  - created_at (timestamptz)

5) logs — системные события.
  - id (bigserial)
  - source (desktop/web)
  - level (info/warning/error)
  - message (text)
  - created_at (timestamptz)

6.2. RPC validate_code_for_checker
Вход:
{ "p_code": "AB12CD" }

Выход (один объект в массиве):
{
 ok: true/false,
 error_code: "ok" | "not_found" | "expired" | "used",
 checker_id: uuid | null,
 checker_name: text | null,
 expires_at: timestamptz | null
}

Чекер при ok=true и error_code="ok" открывает UI. Иначе показывает ошибку.
6.3. RPC register_check
Вход:
{
 "p_code": "AB12CD",
 "p_player_nick": "Player1337",
 "p_player_hwid": "HWID-XXXX",
 "p_status": "cheat" | "clean" | "probably_cheat",
 "p_checked_at": "2026-02-23T20:15:00+03:00" | null,
 "p_source_code": "{...JSON...}"
}

Выход:
[ { "check_id": 123 } ]

При успехе — показать пользователю ID проверки.
6.4. Формат p_source_code (JSON-отчёт)
Рекомендуемый формат (строка JSON):
{
 "system": { ... см. раздел 3.5 ... },
 "twinks": [ { "nick": "...", "source": "usercache.json", "path": "C:/..." }, ... ],
 "mods": [ { "file": "baritone-1.20.1.jar", "size_mb": 3.2, "path": "C:/..." }, ... ],
 "injects": {
   "found": true,
   "matches": ["cortex", "TriggerBOT"],
   "decision": "cortex_detected",
   "comment": "Найдены сигнатуры cortex/TriggerBOT в памяти javaw.exe"
 },
 "extra": {
   "processes": [ ... ],
   "file_changes": [ ... ],
   "dps_tags": [ ... ]
 },
 "notes": "Комментарий проверяющего"
}
7. Веб-панель AvnChecker
7.1. Роли пользователей
- user — обычный пользователь (может ничего не видеть, либо только общую инфу).
- checker — проверяющий:
 • может генерировать коды для чекера;
 • видит только свои проверки.
- admin — администратор:
 • видит все проверки;
 • может управлять ролями и чёрным списком.

7.2. Основные страницы
/login — авторизация (Supabase Auth).
/dashboard — общая статистика (для admin).
/checks — список проверок.
/checks/:id — детальная проверка.
/codes — генерация одноразовых кодов.
/blacklist — управление чёрным списком.
7.3. Генерация кодов (страница /codes)
- Checker или admin жмёт «Сгенерировать код».
- Фронтенд вызывает RPC (например, generate_auth_code(p_checker_id)).
- Supabase создаёт запись в auth_codes и возвращает code + expires_at.
- Код отображается в UI, пользователь вручную вводит его в чекере.
- Telegram-бот нигде не используется.
7.4. Просмотр проверок
Список (/checks):
- Таблица: ID / Ник / HWID / Статус / Проверяющий / Дата.
- Фильтры по нику, HWID, статусу и дате.

Детальная (/checks/:id):
- Основные поля: ник, HWID, статус, время.
- Вкладка System — данные из source_code.system.
- Вкладка Twinks — список твинков.
- Вкладка Mods — список модов.
- Вкладка Injects — найденные сигнатуры, решение.
- Вкладка Extra — доп. данные (processes, file_changes, dps_tags).
7.5. Чёрный список (/blacklist)
- Таблица: Ник / HWID / Причина / Кто добавил / Дата.
- Admin может:
 • добавить запись (по ник/ HWID);
 • удалить запись;
 • использовать быстрые кнопки из просмотра проверки («Добавить в ЧС»).

8. RLS и безопасность
- Таблица checks:
 • checker видит строки, где checks.checker_id = его id;
 • admin видит всё.
- Таблица auth_codes:
 • checker/admin видит только свои коды.
- Таблица blacklist:
 • чтение — checker/admin;
 • запись — только admin.
- Десктоп-чекер использует сервисный ключ только для RPC-функций validate_code_for_checker и register_check (через прокси или безопасную конфигурацию).
9. Критерии приёмки системы
1) Чекер:
- Без кода UI не открывается.
- Все вкладки (Информация, Приложения, О системе, Твинки, Mods, Настройки) работают.
- Сбор системы, твинков, модов и инжектов корректен.
- JSON-отчёт формируется и отправляется в Supabase.

2) Бэкенд:
- Таблицы и RPC реализованы по описанию.
- RLS-политики не дают утечек данных.

3) Веб-панель:
- Генерация кодов работает.
- Список и детали проверок отображаются корректно.
- Роли (checker/admin) работают согласно описанию.

4) Вся система в целом:
- От генерации кода до просмотра проверки на сайте весь сценарий работает стабильно.
- Ошибки сети/БД обрабатываются корректно, без крэшей чекера.