<Window x:Class="HolyChecker.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:HolyChecker.ViewModels"
        xmlns:conv="clr-namespace:HolyChecker.Converters"
        Title="HolyChecker 1.0" Height="720" Width="1100"
        WindowStyle="None" AllowsTransparency="True"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        ResizeMode="CanResizeWithGrip">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolVis"/>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </Window.Resources>

    <Border Background="{StaticResource BgDarkBrush}" CornerRadius="16" BorderBrush="#FF222222" BorderThickness="1">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Background="{StaticResource BgMediumBrush}" CornerRadius="16,0,0,16">
                <DockPanel>
                    <Border DockPanel.Dock="Top" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown" Background="Transparent" Height="36"/>

                    <StackPanel DockPanel.Dock="Top" Margin="20,0,20,24">
                        <StackPanel Orientation="Horizontal">
                            <Border Width="38" Height="38" CornerRadius="10" Background="{StaticResource AccentBrush}" Margin="0,0,12,0">
                                <TextBlock Text="HC" Foreground="White" FontSize="15" FontWeight="Bold"
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="HolyChecker" Foreground="White" FontSize="17" FontWeight="Bold"/>
                                <TextBlock Text="v1.0 | by avncode" Foreground="{StaticResource TextMutedBrush}" FontSize="11"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel DockPanel.Dock="Top" Margin="8,0">
                        <RadioButton x:Name="NavProcess" Content="&#x25B6;  Процессы" Style="{StaticResource NavButton}" IsChecked="True" GroupName="nav"/>
                        <RadioButton x:Name="NavSystem" Content="&#x2699;  Система" Style="{StaticResource NavButton}" GroupName="nav"/>
                        <RadioButton x:Name="NavTools" Content="&#x2B73;  Приложения" Style="{StaticResource NavButton}" GroupName="nav"/>
                        <RadioButton x:Name="NavQueries" Content="&#x2315;  Запросы" Style="{StaticResource NavButton}" GroupName="nav"/>
                    </StackPanel>

                    <Border DockPanel.Dock="Bottom" Padding="14,10" Margin="8,0,8,12" CornerRadius="10" Background="{StaticResource BgCardBrush}">
                        <TextBlock Text="{Binding StatusText}" Foreground="{StaticResource TextMutedBrush}" FontSize="11" TextWrapping="Wrap"/>
                    </Border>
                </DockPanel>
            </Border>

            <Grid Grid.Column="1">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,10,14,0" Panel.ZIndex="10">
                    <Button Content="&#x2015;" FontSize="10" Width="32" Height="32" Foreground="{StaticResource TextMutedBrush}"
                            Background="Transparent" BorderThickness="0" Cursor="Hand" Click="Minimize_Click">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="b" Background="Transparent" CornerRadius="8" Width="32" Height="32">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="b" Property="Background" Value="{StaticResource BgHoverBrush}"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Content="&#x2610;" FontSize="12" Width="32" Height="32" Foreground="{StaticResource TextMutedBrush}"
                            Background="Transparent" BorderThickness="0" Cursor="Hand" Click="Maximize_Click">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="b" Background="Transparent" CornerRadius="8" Width="32" Height="32">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="b" Property="Background" Value="{StaticResource BgHoverBrush}"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Content="&#x2715;" FontSize="12" Width="32" Height="32" Foreground="{StaticResource TextMutedBrush}"
                            Background="Transparent" BorderThickness="0" Cursor="Hand" Click="Close_Click">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="b" Background="Transparent" CornerRadius="8" Width="32" Height="32">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="b" Property="Background" Value="#40FF4444"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>

                <ScrollViewer VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Disabled" Margin="28,48,28,16">
                    <Grid>

                        <Grid Visibility="{Binding IsChecked, ElementName=NavProcess, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <TextBlock Text="Информация о процессе" Style="{StaticResource SectionTitle}" FontSize="22" Margin="0,0,0,4"/>
                                <TextBlock Text="Мониторинг javaw.exe и сетевых подключений" Style="{StaticResource InfoLabel}" Margin="0,0,0,20"/>

                                <Border Style="{StaticResource CardBorder}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                <Ellipse Width="10" Height="10" Margin="0,0,8,0">
                                                    <Ellipse.Style>
                                                        <Style TargetType="Ellipse">
                                                            <Setter Property="Fill" Value="{StaticResource RedBrush}"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding ProcessInfo.IsRunning}" Value="True">
                                                                    <Setter Property="Fill" Value="{StaticResource GreenBrush}"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Ellipse.Style>
                                                </Ellipse>
                                                <TextBlock Text="{Binding ProcessInfo.StatusText}" Style="{StaticResource InfoValue}" FontSize="15"/>
                                            </StackPanel>
                                            <Grid Margin="0,8,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0" Margin="0,0,16,0">
                                                    <TextBlock Text="PID" Style="{StaticResource InfoLabel}"/>
                                                    <TextBlock Text="{Binding ProcessInfo.Pid}" Style="{StaticResource InfoValue}"/>
                                                </StackPanel>
                                                <StackPanel Grid.Column="1" Margin="0,0,16,0">
                                                    <TextBlock Text="Версия" Style="{StaticResource InfoLabel}"/>
                                                    <TextBlock Text="{Binding ProcessInfo.Version}" Style="{StaticResource InfoValue}"/>
                                                </StackPanel>
                                                <StackPanel Grid.Column="2" Margin="0,0,16,0">
                                                    <TextBlock Text="Сервер" Style="{StaticResource InfoLabel}"/>
                                                    <TextBlock Text="{Binding ProcessInfo.ServerIp}" Style="{StaticResource InfoValue}" Foreground="{StaticResource AccentBrush}"/>
                                                </StackPanel>
                                                <StackPanel Grid.Column="3">
                                                    <TextBlock Text="Путь" Style="{StaticResource InfoLabel}"/>
                                                    <TextBlock Text="{Binding ProcessInfo.ProcessPath}" Style="{StaticResource InfoValue}"
                                                               TextTrimming="CharacterEllipsis" ToolTip="{Binding ProcessInfo.ProcessPath}"/>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                        <Button Grid.Column="1" Content="Обновить" Style="{StaticResource AccentBtn}"
                                                Command="{Binding ProcessInfo.RefreshCommand}" VerticalAlignment="Top"/>
                                    </Grid>
                                </Border>

                                <TextBlock Text="TCP-подключения" Style="{StaticResource SectionTitle}" Margin="0,4,0,0"/>
                                <Border Style="{StaticResource CardBorder}" Padding="0">
                                    <DataGrid ItemsSource="{Binding ProcessInfo.Connections}" AutoGenerateColumns="False"
                                              IsReadOnly="True" HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                              Background="Transparent" BorderThickness="0" RowBackground="Transparent"
                                              AlternatingRowBackground="#08FFFFFF" Foreground="{StaticResource TextPrimaryBrush}"
                                              ColumnHeaderHeight="36" RowHeight="32" FontSize="12">
                                        <DataGrid.ColumnHeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="Background" Value="{StaticResource BgHoverBrush}"/>
                                                <Setter Property="Foreground" Value="{StaticResource AccentBrush}"/>
                                                <Setter Property="Padding" Value="12,8"/>
                                                <Setter Property="FontSize" Value="11"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                                <Setter Property="BorderThickness" Value="0"/>
                                            </Style>
                                        </DataGrid.ColumnHeaderStyle>
                                        <DataGrid.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="Padding" Value="12,6"/>
                                                <Setter Property="BorderThickness" Value="0"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="DataGridCell">
                                                            <Border Padding="{TemplateBinding Padding}" Background="Transparent">
                                                                <ContentPresenter VerticalAlignment="Center"/>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </DataGrid.CellStyle>
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="ЛОКАЛЬНЫЙ" Binding="{Binding LocalAddress}" Width="*"/>
                                            <DataGridTextColumn Header="ПОРТ" Binding="{Binding LocalPort}" Width="70"/>
                                            <DataGridTextColumn Header="УДАЛЁННЫЙ" Binding="{Binding RemoteAddress}" Width="*"/>
                                            <DataGridTextColumn Header="ПОРТ" Binding="{Binding RemotePort}" Width="70"/>
                                            <DataGridTextColumn Header="СТАТУС" Binding="{Binding State}" Width="100"/>
                                            <DataGridTextColumn Header="СЕРВЕР" Binding="{Binding ServerName}" Width="*"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </StackPanel>
                        </Grid>


                        <Grid Visibility="{Binding IsChecked, ElementName=NavSystem, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="Информация о системе" Style="{StaticResource SectionTitle}" FontSize="22" Margin="0,0,0,4"/>
                                        <TextBlock Text="Windows, службы, журналы событий и обнаружение ВМ" Style="{StaticResource InfoLabel}" Margin="0,0,0,20"/>
                                    </StackPanel>
                                    <Button Grid.Column="1" Content="Обновить" Style="{StaticResource AccentBtn}" VerticalAlignment="Top"
                                            Command="{Binding SystemInfo.RefreshCommand}"/>
                                </Grid>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="12"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Border Grid.Column="0" Style="{StaticResource CardBorder}">
                                        <StackPanel>
                                            <TextBlock Text="Windows" Style="{StaticResource SectionTitle}" FontSize="14"/>
                                            <StackPanel Margin="0,4,0,0">
                                                <TextBlock Text="Дата установки" Style="{StaticResource InfoLabel}"/>
                                                <TextBlock Text="{Binding SystemInfo.InstallDate}" Style="{StaticResource InfoValue}" Margin="0,2,0,10"/>
                                                <TextBlock Text="Версия" Style="{StaticResource InfoLabel}"/>
                                                <TextBlock Text="{Binding SystemInfo.WindowsVersion}" Style="{StaticResource InfoValue}" Margin="0,2,0,10"/>
                                                <TextBlock Text="Сборка" Style="{StaticResource InfoLabel}"/>
                                                <TextBlock Text="{Binding SystemInfo.WindowsBuild}" Style="{StaticResource InfoValue}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="2" Style="{StaticResource CardBorder}">
                                        <StackPanel>
                                            <TextBlock Text="Безопасность" Style="{StaticResource SectionTitle}" FontSize="14"/>
                                            <StackPanel Margin="0,4,0,0">
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                    <TextBlock Text="Админ: " Style="{StaticResource InfoLabel}"/>
                                                    <TextBlock>
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock" BasedOn="{StaticResource InfoValue}">
                                                                <Setter Property="Text" Value="Нет"/>
                                                                <Setter Property="Foreground" Value="{StaticResource YellowBrush}"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding SystemInfo.IsAdmin}" Value="True">
                                                                        <Setter Property="Text" Value="Да"/>
                                                                        <Setter Property="Foreground" Value="{StaticResource GreenBrush}"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                    <TextBlock Text="Событие 3079: " Style="{StaticResource InfoLabel}"/>
                                                    <TextBlock>
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock" BasedOn="{StaticResource InfoValue}">
                                                                <Setter Property="Text" Value="Не найдено"/>
                                                                <Setter Property="Foreground" Value="{StaticResource GreenBrush}"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding SystemInfo.Event3079Found}" Value="True">
                                                                        <Setter Property="Text" Value="НАЙДЕНО"/>
                                                                        <Setter Property="Foreground" Value="{StaticResource RedBrush}"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                    <TextBlock Text="Журналы очищены: " Style="{StaticResource InfoLabel}"/>
                                                    <TextBlock>
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock" BasedOn="{StaticResource InfoValue}">
                                                                <Setter Property="Text" Value="Нет"/>
                                                                <Setter Property="Foreground" Value="{StaticResource GreenBrush}"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding SystemInfo.LogsCleared}" Value="True">
                                                                        <Setter Property="Text" Value="ДА"/>
                                                                        <Setter Property="Foreground" Value="{StaticResource RedBrush}"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </StackPanel>
                                                <TextBlock Text="Последняя очистка" Style="{StaticResource InfoLabel}"/>
                                                <TextBlock Text="{Binding SystemInfo.LastClearDate}" Style="{StaticResource InfoValue}" Margin="0,2,0,10"/>
                                                <TextBlock Text="Корзина изменена" Style="{StaticResource InfoLabel}"/>
                                                <TextBlock Text="{Binding SystemInfo.RecycleBinDate}" Style="{StaticResource InfoValue}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </Grid>

                                <Border Style="{StaticResource CardBorder}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                            <TextBlock Text="Обнаружение ВМ" Style="{StaticResource SectionTitle}" FontSize="14" Margin="0"/>
                                            <Border CornerRadius="6" Padding="8,3" Margin="12,0,0,0" VerticalAlignment="Center">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Background" Value="#2044CC44"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SystemInfo.VmInfo.IsVirtualMachine}" Value="True">
                                                                <Setter Property="Background" Value="#20FC5C5C"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <TextBlock FontSize="11" FontWeight="SemiBold">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Text" Value="Физическая машина"/>
                                                            <Setter Property="Foreground" Value="{StaticResource GreenBrush}"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SystemInfo.VmInfo.IsVirtualMachine}" Value="True">
                                                                    <Setter Property="Text" Value="Обнаружена виртуальная машина"/>
                                                                    <Setter Property="Foreground" Value="{StaticResource RedBrush}"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Border>
                                        </StackPanel>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Платформа" Style="{StaticResource InfoLabel}"/>
                                                <TextBlock Text="{Binding SystemInfo.VmInfo.DetectedPlatform}" Style="{StaticResource InfoValue}"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="Производитель" Style="{StaticResource InfoLabel}"/>
                                                <TextBlock Text="{Binding SystemInfo.VmInfo.Manufacturer}" Style="{StaticResource InfoValue}" TextTrimming="CharacterEllipsis"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="MAC-адрес" Style="{StaticResource InfoLabel}"/>
                                                <TextBlock Text="{Binding SystemInfo.VmInfo.MacAddress}" Style="{StaticResource InfoValue}" TextTrimming="CharacterEllipsis"/>
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <TextBlock Text="Службы" Style="{StaticResource SectionTitle}" Margin="0,4,0,0"/>
                                <Border Style="{StaticResource CardBorder}" Padding="0">
                                    <ItemsControl ItemsSource="{Binding SystemInfo.Services}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Padding="16,10" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="{Binding Name}" Style="{StaticResource InfoValue}"/>
                                                        <Border Grid.Column="1" CornerRadius="4" Padding="8,3" Margin="8,0" Background="#15FFFFFF">
                                                            <TextBlock Text="{Binding StartupType}" Foreground="{StaticResource TextMutedBrush}" FontSize="11"/>
                                                        </Border>
                                                        <TextBlock Grid.Column="2" Text="{Binding Status}" FontSize="12" FontWeight="SemiBold" MinWidth="80" TextAlignment="Right">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Foreground" Value="{StaticResource YellowBrush}"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Status}" Value="Running">
                                                                            <Setter Property="Foreground" Value="{StaticResource GreenBrush}"/>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding Status}" Value="Not Found">
                                                                            <Setter Property="Foreground" Value="{StaticResource RedBrush}"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Border>
                            </StackPanel>
                        </Grid>

                        <Grid Visibility="{Binding IsChecked, ElementName=NavTools, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <TextBlock Text="Приложения" Style="{StaticResource SectionTitle}" FontSize="22" Margin="0,0,0,4"/>
                                <TextBlock Text="Скачивание и запуск утилит для анализа" Style="{StaticResource InfoLabel}" Margin="0,0,0,20"/>

                                <ItemsControl ItemsSource="{Binding Tools.Tools}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <UniformGrid Columns="3"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Style="{StaticResource CardBorder}" Margin="0,0,8,8" MinHeight="180">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
                                                        <TextBlock Text="{Binding Name}" Style="{StaticResource InfoValue}" FontSize="14"/>
                                                        <Border CornerRadius="4" Padding="6,2" Margin="8,0,0,0" VerticalAlignment="Center">
                                                            <Border.Style>
                                                                <Style TargetType="Border">
                                                                    <Setter Property="Background" Value="#20FC5C5C"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                                            <Setter Property="Background" Value="#2044CC44"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Border.Style>
                                                            <TextBlock FontSize="10" FontWeight="SemiBold">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Text" Value="Не скачано"/>
                                                                        <Setter Property="Foreground" Value="{StaticResource RedBrush}"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                                                <Setter Property="Text" Value="Готово"/>
                                                                                <Setter Property="Foreground" Value="{StaticResource GreenBrush}"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Border>
                                                    </StackPanel>
                                                    <TextBlock Grid.Row="1" Text="{Binding Status}" Foreground="{StaticResource TextSecondaryBrush}"
                                                               FontSize="11" Margin="0,0,0,4"/>
                                                    <TextBlock Grid.Row="2" Text="{Binding Description}" Foreground="{StaticResource TextMutedBrush}" FontSize="12"
                                                               Margin="0,0,0,12" TextWrapping="Wrap" VerticalAlignment="Top"/>
                                                    <Button Grid.Row="3" Content="Запуск" Style="{StaticResource AccentBtn}"
                                                            HorizontalAlignment="Stretch" VerticalAlignment="Bottom"
                                                            Command="{Binding DataContext.Tools.LaunchCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                            CommandParameter="{Binding}"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Grid>

                        <Grid Visibility="{Binding IsChecked, ElementName=NavQueries, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <TextBlock Text="Запросы Everything" Style="{StaticResource SectionTitle}" FontSize="22" Margin="0,0,0,4"/>
                                <TextBlock Text="Готовые поисковые запросы для Everything" Style="{StaticResource InfoLabel}" Margin="0,0,0,20"/>

                                <ItemsControl ItemsSource="{Binding EverythingQueries.Queries}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Style="{StaticResource CardBorder}" Margin="0,0,0,8">
                                                <StackPanel>
                                                    <Grid Margin="0,0,0,8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="{Binding Name}" Style="{StaticResource InfoValue}" FontSize="14" VerticalAlignment="Center"/>
                                                        <TextBlock Grid.Column="1" Text="{Binding CopyStatus}" Foreground="{StaticResource GreenBrush}"
                                                                   FontSize="11" VerticalAlignment="Center" Margin="8,0"/>
                                                        <Button Grid.Column="2" Content="Копировать" Style="{StaticResource GhostBtn}"
                                                                Command="{Binding DataContext.EverythingQueries.CopyCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                CommandParameter="{Binding}"/>
                                                    </Grid>
                                                    <Border Background="{StaticResource BgDarkBrush}" CornerRadius="6" Padding="12,10">
                                                        <TextBlock Text="{Binding Query}" Foreground="{StaticResource TextMutedBrush}" FontSize="11"
                                                                   TextWrapping="Wrap" FontFamily="Consolas"/>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Grid>

                    </Grid>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Border>
</Window>
